geom_bar(stat= "identity") +
facet_wrap(~Bike_Type) +
labs(title="Total Ride Time of All Riders", x = "", y = "Years")
#percentage of riders using docked bikes
df_nocoordinates3 %>%
group_by(Rider_Type, Bike_Type) %>%
summarise(mean = mean(Trip_Time_Minutes), n= n()) %>%
mutate(Ride_time_in_years = mean*n/60/24/365) %>%
ggplot(mapping = aes(x = Rider_Type, y = Ride_time_in_years)) +
geom_bar(stat= "identity") +
facet_wrap(~Bike_Type) +
labs(title="Total Ride Time of All Riders", x = "", y = "Years")
ggplot(data = df_nocoordinates3, aes(x = Trip_Time_Minutes)) +
facet_wrap(~Bike_Type) +
geom_point() +
labs(title="Total time per ride", x = "Minutes", y = "")
ggplot(data = df_nocoordinates3, aes(x = Trip_Time_Minutes)) +
facet_wrap(~Bike_Type) +
geom_point() +
labs(title="Total time per ride", x = "Minutes", y = "")
df_renamed %>%
group_by(Bike_Type, Rider_Type) %>%
summarise("Start station latitudes" = n_distinct(start_lat), "Start station longitudes" = n_distinct(start_lng), "End station latitudes" = n_distinct(end_lat), "End station longitudes" = n_distinct(end_lng)) %>%
gather(Bike_Type, value, "Start station latitudes", "Start station longitudes", "End station latitudes", "End station longitudes") %>% #unpivots chart
ggplot(mapping = aes(x = Rider_Type, y=value)) +
geom_bar(stat = "identity") +
facet_wrap(~Bike_Type) +
labs(title="Unique Values for geographical cooridnates", x = "", y = "Count of unique values")
df_renamed %>%
group_by(Bike_Type, Rider_Type) %>%
summarise("Start station latitudes" = n_distinct(start_lat), "Start station longitudes" = n_distinct(start_lng), "End station latitudes" = n_distinct(end_lat), "End station longitudes" = n_distinct(end_lng)) %>%
gather(Bike_Type, value, "Start station latitudes", "Start station longitudes", "End station latitudes", "End station longitudes") %>% #unpivots chart
ggplot(mapping = aes(x = Rider_Type, y=value)) +
geom_bar(stat = "identity") +
facet_wrap(~Bike_Type) +
labs(title="Count of unique values of geographical coordinates", x = "", y = "Unique instances")
?geom_point
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(end_station_id)) + geom_bar(aes(fill=end_station_id)) +
coord_flip()
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(end_station_id)) + geom_bar(aes(fill=end_station_id)) +
coord_flip() +
labs(title = "Docked bikes end stations", x = "", y = "")
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(end_station_id)) + geom_bar(aes(fill=end_station_id)) +
coord_flip() +
labs(title = "Docked bikes end stations", x = "", y = "") + theme_bw()
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(end_station_id)) + geom_bar(aes(fill=end_station_id)) +
coord_flip() +
labs(title = "Docked bikes end stations", x = "", y = "")
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(end_station_id)) + geom_bar(aes(fill=end_station_id)) +
coord_flip() +
labs(title = "Docked bikes end stations", x = "", y = "") + theme_classic()
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(start_station_id)) +
geom_bar(aes(fill=start_station_id)) +
coord_flip() +
theme_classic()
df_nocoordinates3_dockedhigh %>%
top_n(10)
df_nocoordinates3_dockedhigh %>%
top_n(10) %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(start_station_id)) +
geom_bar(aes(fill=start_station_id)) +
coord_flip() +
theme_classic()
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
top_n(10) %>%
ggplot(aes(start_station_id)) +
geom_bar(aes(fill=start_station_id)) +
coord_flip() +
theme_classic()
?top_n
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(end_station_id)) + geom_bar(aes(fill=end_station_id)) +
labs(title = "Docked bikes end stations", x = "", y = "") +
coord_flip() +
theme_classic()
#percentage of riders using docked bikes
df_nocoordinates3 %>%
group_by(Rider_Type, Bike_Type) %>%
summarise(mean = mean(Trip_Time_Minutes), n= n()) %>%
mutate(Ride_time_in_years = mean*n/60/24/365) %>%
ggplot(mapping = aes(x = Rider_Type, y = Ride_time_in_years)) +
geom_bar(stat= "identity") +
facet_wrap(~Bike_Type) +
labs(title="Total Ride Time of All Riders", x = "", y = "Years") +
theme_classic()
#percentage of riders using docked bikes
df_nocoordinates3 %>%
group_by(Rider_Type, Bike_Type) %>%
summarise(mean = mean(Trip_Time_Minutes), n= n()) %>%
mutate(Ride_time_in_years = mean*n/60/24/365) %>%
ggplot(mapping = aes(x = Rider_Type, y = Ride_time_in_years)) +
geom_bar(stat= "identity") +
facet_wrap(~Bike_Type) +
labs(title="Total Ride Time of All Riders", x = "", y = "Years") +
theme_dark()
#percentage of riders using docked bikes
df_nocoordinates3 %>%
group_by(Rider_Type, Bike_Type) %>%
summarise(mean = mean(Trip_Time_Minutes), n= n()) %>%
mutate(Ride_time_in_years = mean*n/60/24/365) %>%
ggplot(mapping = aes(x = Rider_Type, y = Ride_time_in_years)) +
geom_bar(stat= "identity") +
facet_wrap(~Bike_Type) +
labs(title="Total Ride Time of All Riders", x = "", y = "Years") +
theme_light()
#percentage of riders using docked bikes
df_nocoordinates3 %>%
group_by(Rider_Type, Bike_Type) %>%
summarise(mean = mean(Trip_Time_Minutes), n= n()) %>%
mutate(Ride_time_in_years = mean*n/60/24/365) %>%
ggplot(mapping = aes(x = Rider_Type, y = Ride_time_in_years)) +
geom_bar(stat= "identity") +
facet_wrap(~Bike_Type) +
labs(title="Total Ride Time of All Riders", x = "", y = "Years") +
theme_minimal()
#percentage of riders using docked bikes
df_nocoordinates3 %>%
group_by(Rider_Type, Bike_Type) %>%
summarise(mean = mean(Trip_Time_Minutes), n= n()) %>%
mutate(Ride_time_in_years = mean*n/60/24/365) %>%
ggplot(mapping = aes(x = Rider_Type, y = Ride_time_in_years)) +
geom_bar(stat= "identity") +
facet_wrap(~Bike_Type) +
labs(title="Total Ride Time of All Riders", x = "", y = "Years") +
theme_void()
#percentage of riders using docked bikes
df_nocoordinates3 %>%
group_by(Rider_Type, Bike_Type) %>%
summarise(mean = mean(Trip_Time_Minutes), n= n()) %>%
mutate(Ride_time_in_years = mean*n/60/24/365) %>%
ggplot(mapping = aes(x = Rider_Type, y = Ride_time_in_years)) +
geom_bar(stat= "identity") +
facet_wrap(~Bike_Type) +
labs(title="Total Ride Time of All Riders", x = "", y = "Years") +
theme_linedraw()
#percentage of riders using docked bikes
df_nocoordinates3 %>%
group_by(Rider_Type, Bike_Type) %>%
summarise(mean = mean(Trip_Time_Minutes), n= n()) %>%
mutate(Ride_time_in_years = mean*n/60/24/365) %>%
ggplot(mapping = aes(x = Rider_Type, y = Ride_time_in_years)) +
geom_bar(stat= "identity") +
facet_wrap(~Bike_Type) +
labs(title="Total Ride Time of All Riders", x = "", y = "Years") +
theme_gray()
#percentage of riders using docked bikes
df_nocoordinates3 %>%
group_by(Rider_Type, Bike_Type) %>%
summarise(mean = mean(Trip_Time_Minutes), n= n()) %>%
mutate(Ride_time_in_years = mean*n/60/24/365) %>%
ggplot(mapping = aes(x = Rider_Type, y = Ride_time_in_years)) +
geom_bar(stat= "identity") +
facet_wrap(~Bike_Type) +
labs(title="Total Ride Time of All Riders", x = "", y = "Years") +
theme_grey()
#percentage of riders using docked bikes
df_nocoordinates3 %>%
group_by(Rider_Type, Bike_Type) %>%
summarise(mean = mean(Trip_Time_Minutes), n= n()) %>%
mutate(Ride_time_in_years = mean*n/60/24/365) %>%
ggplot(mapping = aes(x = Rider_Type, y = Ride_time_in_years)) +
geom_bar(stat= "identity") +
facet_wrap(~Bike_Type) +
labs(title="Total Ride Time of All Riders", x = "", y = "Years")
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes, y=Bike_Type)) +
geom_boxplot(outlier.colour="red", outlier.shape=2,
outlier.size=1) +
coord_flip() +
labs(title="Trip time per for docked bikes (casual riders)", x = "Minutes", y = "") +
theme_bw()
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes, y=Bike_Type)) +
geom_boxplot(outlier.colour="red", outlier.shape=2,
outlier.size=1) +
coord_flip() +
labs(title="Trip time per for docked bikes (casual riders)", x = "Minutes", y = "") +
theme_classic()
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes, y=Bike_Type)) +
geom_histogram()
))
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram()
?geom_histogram
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=50)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=1000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=10000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=1000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=20)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=10)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=5)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=5) + ylim(0,5000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=5) + ylim(0,2000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=end_station_id)) +
geom_histogram(binwidth=5)
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=end_station_id)) +
geom_histogram(binwidth=5)
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=end_station_id, stat="count")) +
geom_histogram(binwidth=5)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=500) + ylim(0,2000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=500) + ylim(0,1000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=500) + ylim(0,2000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=500) + ylim(0,5000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=500) + ylim(0,10000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=500) + ylim(0,1000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=500) #+ ylim(0,1000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=500) + ylim(0,1000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=500) #+ ylim(0,1000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=500) + ylim(0,1000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=500) + ylim(0,500)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=100) #+ ylim(0,500)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=1000) #+ ylim(0,500)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=500) #+ ylim(0,500)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=200) #+ ylim(0,500)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=300) #+ ylim(0,500)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=300) + ylim(0,5000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=300) + ylim(0,10000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=300) #+ ylim(0,10000)
```{r}
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=300) #+ ylim(0,10000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=1000) #+ ylim(0,10000)
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=1000) labs(title = "Trip time in minutes divided into steps of 1,000")
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=1000) +
labs(title = "Trip time in minutes divided into steps of 1,000")
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=1000) +
labs(title = "Counts of trip times in minutes for docked bike rides, divided into steps of 1,000")
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=1000) +
labs(title = "Counts of trip times in minutes for docked bikes, divided into steps of 1,000")
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=1000) +
labs(title = "Counts of trip times in minutes for docked bikes")
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=1000) +
labs(title = "Counts of trip times in minutes for docked bikes", x = "Trip times in minute", y = "counts")
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=1000) +
labs(title = "Counts of trip times in minutes for docked bikes", x = "Trip times in minutes", y = "counts")
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=1000) +
labs(title = "Counts of trip times in minutes for docked bikes", x = "Trip times in minutes", y = "Occurances")
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=1000) +
labs(title = "Counts of trip times in minutes for docked bikes", x = "Trip times in minutes", y = "Occurances")
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=start_station_id)) +
geom_histogram(binwidth=1000) +
labs(title = "Counts of trip times in minutes for docked bikes", x = "Trip times in minutes", y = "Occurances")
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=start_station_id)) +
geom_histogram(binwidth=1000, stat="count") +
labs(title = "Counts of trip times in minutes for docked bikes", x = "Trip times in minutes", y = "Occurances")
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=start_station_id)) +
geom_histogram(binwidth=1000, stat="count") +
labs(title = "Counts of trip times in minutes for docked bikes", x = "Trip times in minutes", y = "Occurances") +
coord_flip()
df_nocoordinates3_dockedhigh <- df_nocoordinates3[df_nocoordinates3$Trip_Time_Minutes > 20000, ]
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(start_station_id)) +
geom_bar(aes(fill=start_station_id)) +
coord_flip() +
theme_classic()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(skimr)
library(janitor)
#library(reshape)#dataframe manipulation
#read all the CSV files of trip data for the past 12 months as dataframes in R
df_202110 <- read_csv("202110-divvy-tripdata.csv")
df_202111 <- read_csv("202111-divvy-tripdata.csv")
df_202112 <- read_csv("202112-divvy-tripdata.csv")
df_202201 <- read_csv("202201-divvy-tripdata.csv")
df_202202 <- read_csv("202202-divvy-tripdata.csv")
df_202203 <- read_csv("202203-divvy-tripdata.csv")
df_202204 <- read_csv("202204-divvy-tripdata.csv")
df_202205 <- read_csv("202205-divvy-tripdata.csv")
df_202206 <- read_csv("202206-divvy-tripdata.csv")
df_202207 <- read_csv("202207-divvy-tripdata.csv")
df_202208 <- read_csv("202208-divvy-tripdata.csv")
df_202209 <- read_csv("202209-divvy-publictripdata.csv")
#append all months into single dataframe
df <- rbind(df_202110, df_202111,df_202112, df_202201, df_202202, df_202203, df_202204, df_202205, df_202206, df_202207, df_202208, df_202209)
head(df)
df_renamed <- df %>%
rename(Ride_ID = ride_id) %>%
rename(Bike_Type = rideable_type) %>%
rename(Rider_Type = member_casual)
skim_without_charts(df_renamed)
df_renamed %>%
group_by(Bike_Type, Rider_Type) %>%
summarise("Start station latitudes" = n_distinct(start_lat), "Start station longitudes" = n_distinct(start_lng), "End station latitudes" = n_distinct(end_lat), "End station longitudes" = n_distinct(end_lng)) %>%
gather(Bike_Type, value, "Start station latitudes", "Start station longitudes", "End station latitudes", "End station longitudes") %>% #unpivots chart
ggplot(mapping = aes(x = Rider_Type, y=value)) +
geom_bar(stat = "identity") +
facet_wrap(~Bike_Type) +
labs(title="Count of unique values of geographical coordinates", x = "", y = "Unique instances")
df_nocoordinates <- df_renamed %>%
replace_na(list(start_station_id = 'Missing location ID', end_station_id = 'Missing location ID')) %>%
select(Ride_ID, Bike_Type, start_station_id, end_station_id, started_at, ended_at, Rider_Type)
df_nocoordinates2 <- df_nocoordinates %>%
mutate(Trip_Time_Minutes = (ended_at - started_at)/60) %>%
select(Ride_ID, Bike_Type, start_station_id, end_station_id, Trip_Time_Minutes, Rider_Type)
df_nocoordinates2$Trip_Time_Minutes <- as.numeric(df_nocoordinates2$Trip_Time_Minutes)
#round to nearest minute
df_nocoordinates2$Trip_Time_Minutes <- round(df_nocoordinates2$Trip_Time_Minutes, 0)
glimpse(df_nocoordinates2)
ggplot(data = df_nocoordinates2) +
geom_bar(mapping = aes(x = Rider_Type)) +
facet_wrap(~Bike_Type) +
labs(title="Bike types used by type of rider", x = "", y = "Count of rides")
#percentage of riders using docked bikes
df_nocoordinates2 %>%
summarize(df_nocoordinates2,)
ggplot(data = df_nocoordinates2) +
geom_point(mapping = aes(x = Trip_Time_Minutes, y = Bike_Type)) +
facet_wrap(~Rider_Type) +
labs(title="Total time per ride", x = "Minutes", y = "") +
theme_classic()
paste("There are",sum(df_nocoordinates2$Trip_Time_Minutes < 0),"rows with trip times below 0 minutes.")
#remove observations with values of trip times below 0 minutes
df_nocoordinates3 <- df_nocoordinates2[df_nocoordinates2$Trip_Time_Minutes > 0, ]
glimpse(df_nocoordinates3)
#percentage of riders using docked bikes
df_nocoordinates3 %>%
group_by(Rider_Type, Bike_Type) %>%
summarise(mean = mean(Trip_Time_Minutes), n= n()) %>%
mutate(Ride_time_in_years = mean*n/60/24/365) %>%
ggplot(mapping = aes(x = Rider_Type, y = Ride_time_in_years)) +
geom_bar(stat= "identity") +
facet_wrap(~Bike_Type) +
labs(title="Total Ride Time of All Riders", x = "", y = "Years")
df_nocoordinates3 %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(x=Trip_Time_Minutes)) +
geom_histogram(binwidth=1000) +
labs(title = "Counts of trip times in minutes for docked bikes", x = "Trip times in minutes", y = "Occurances")
df_nocoordinates3_dockedhigh <- df_nocoordinates3[df_nocoordinates3$Trip_Time_Minutes > 20000, ]
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(start_station_id)) +
geom_bar(aes(fill=start_station_id)) +
coord_flip() +
theme_classic()
df_nocoordinates3_dockedhigh %>%
filter(Bike_Type=="docked_bike") %>%
ggplot(aes(end_station_id)) +
geom_bar(aes(fill=end_station_id)) +
labs(title = "Docked bikes end stations", x = "", y = "") +
coord_flip() +
theme_classic()
df_nocoordinates3 %>%
filter(Bike_Type %in% c("electric bike","classic_bike")) %>%
ggplot(aes(x=Trip_Time_Minutes, y=Bike_Type)) + facet_wrap(~ Trip_Time_Minutes)
ggplot(data = df_nocoordinates3, aes(x = Trip_Time_Minutes)) +
facet_wrap(~Bike_Type) +
geom_point() +
labs(title="Total time per ride", x = "Minutes", y = "")
# https://ggplot2.tidyverse.org/reference/geom_density.html
ggplot(data = df_nocoordinates3, aes(Trip_Time_Minutes, after_stat(count)) +
geom_density(position = "stack")
hotel_summary <-
hotel_bookings %>%
group_by(hotel) %>%
summarise(average_lead_time=mean(lead_time),
min_lead_time=min(lead_time),
max_lead_time=max(lead_time))
length(which(df_nocoordinates2$start_station_id == df_nocoordinates2$end_station_id))
paste("There are", sum(df_nocoordinates3$start_station_id == "Missing location ID"), "mising start location IDs.")
paste("There are", sum(df_nocoordinates3$end_station_id == "Missing location ID"), "missing end location IDs.")
